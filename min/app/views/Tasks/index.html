#{extends 'main.html' /}
#{set title:'Tasks' /}
#{set 'moreScripts' }
#{set isNew:false/}
<script type="text/javascript" src="@{'/public/js/tasks.js'}">
</script>
#{/set}

<div class="previews">
    <div id="image_blue_hills" class="preview" style="display:none">
        <!--img src="@{'/public/files/blue_hills.jpg'}"-->
    </div>
</div>
<div class="taskBar">
    <a href="" class="newButton button ui-state-default ui-corner-all">New Task</a>
    <div id="newTask" class="hide">
        <div class="task">
            <div class="move hide">
                <img src="@{'/public/images/arrow-move.png'}"/>
            </div>#{set isNew:true/}
            #{include 'Tasks/task.html'/}
            #{set isNew:false/}
        </div>
    </div>
</div>
<div class="tasks">
    #{list tasks, as:'task'}
    <div class="task">
        <div class="move">
            <img src="@{'/public/images/arrow-move.png'}"/>
        </div>#{include 'Tasks/task.html'/}
    </div>#{/list}
</div>
<div class="filters">
    <h3>Filter Tasks</h3>
    #{form id:'filterForm', action:@Tasks.filter(), method:'post'}
        <ul class="tags">
        #{list models.Tag.ungrouped(), as: "tag"}
            <li><input type="checkbox" name="checkedTags" value="${tag}" #{if checkedTags?.contains(tag.name)}checked #{/if}/>${tag}</li>
        #{/list}
        </ul>

        #{list models.TagGroup.findAll(), as: "tagGroup"}
           #{if !tagGroup.tags.isEmpty()}
               <div class="tagGroup">
                   <div class="name">${tagGroup.name}</div>

                   <ul class="tags">
                        #{list tagGroup.tags, as: "tag"}
                            <li><input type="checkbox" name="checkedTags" value="${tag}" #{if checkedTags?.contains(tag.name)}checked #{/if}/>${tag}</li>
                        #{/list}
                    </ul>
                </div>
            #{/if}
        #{/list}

        <hr/>
        <input type="submit" name="action" value="Filter"/>
    #{/form}
</div>
<div id="mask">
</div>