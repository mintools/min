#{set allMembers: models.Member.getMembers()/}

#{form id:'filterForm', action:@Tasks.filter(), method:'post'}
    <div class="filterContainer">

        <fieldset>
            <legend>Filter Text</legend>

            <input type="text" name="searchText" value="${searchText}" size="30"/>
        </fieldset>

        <div class="column">
            #{list models.TagGroup.findAll(), as: "tagGroup"}
               #{if !tagGroup.tags.isEmpty()}
                   <fieldset>
                        <legend>${tagGroup.name}</legend>

                        <ul class="tags">
                            #{list tagGroup.tags, as: "tag"}
                                <li><input type="checkbox" name="checkedTags" value="${tag.id}" #{if checkedTags?.contains(tag.id.toString())}checked #{/if}/>${tag}</li>
                            #{/list}
                            <!--<hr/>-->
                            <!--<li><input type="checkbox" name="noTag" value="${tagGroup.id}" #{if noTag?.contains(tagGroup.id?.toString())}checked #{/if}/>No ${tagGroup.name}</li>-->
                        </ul>
                   </fieldset>
                #{/if}
            #{/list}

            <fieldset>
                <legend>Other</legend>

                <ul class="tags">
                #{list models.Tag.ungrouped(), as: "tag"}
                    <li><input type="checkbox" name="checkedTags" value="${tag.id}" #{if checkedTags?.contains(tag.id.toString())}checked #{/if}/>${tag}</li>
                #{/list}
                </ul>
            </fieldset>
        </div>

        <div class="column">
            <fieldset>
                <legend>Members</legend>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>Raised By</th>
                            <th>Assigned To</th>
                        </tr>
                    </thead>
                    #{list allMembers, as: "member"}
                        <tr>
                            <td>
                                ${member.username}
                            </td>
                            <td>
                                <input type="checkbox" name="raisedBy" value="${member.id}" #{if raisedBy?.contains(member.id.toString())}checked#{/if}/>
                            </td>
                            <td>
                                <input type="checkbox" name="assignedTo" value="${member.id}" #{if assignedTo?.contains(member.id.toString())}checked#{/if}/>
                            </td>
                        </tr>
                    #{/list}
                    <tr>
                        <td>Unassigned</td>
                        <td></td>
                        <td><input type="checkbox" name="assignedTo" value="unassigned" #{if assignedTo?.contains('unassigned')}checked#{/if}/></td>
                    </tr>
                </table>
            </fieldset>
        </div>
    </div>
        
    <hr/>


    <input type="submit" name="action" value="Filter"/>
#{/form}